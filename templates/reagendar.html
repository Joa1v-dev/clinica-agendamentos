<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Reagendar Consulta</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
    <div class="container">
        <button id="modo-toggle" class="btn-secondary" style="float: right;">üåì Dark Mode</button>
        <h2>‚ôªÔ∏è Reagendar Consulta</h2>
        <a class="btn-secondary" href="{{ url_for('listar_consultas') }}">‚Üê Voltar para Consultas</a>
        <br><br>
        <form method="POST" class="form">
            <label for="medico">M√©dico</label>
            <select name="medico" id="medico" required>
                <option value="">Selecione um m√©dico</option>
                {% for medico in medicos %}
                    <option value="{{ medico['id'] }}">{{ medico['nome'] }}</option>
                {% endfor %}
            </select>

            <label for="agenda">Escolha um novo hor√°rio:</label>
            <select name="agenda" id="agenda" required>
                <option value="">Escolha um m√©dico primeiro</option>
            </select>

            <button type="submit" class="btn-primary">‚úÖ Confirmar</button>
        </form>
    </div>

<script>
document.getElementById('medico').addEventListener('change', function() {
    const medicoId = this.value;
    const selectAgenda = document.getElementById('agenda');
    selectAgenda.innerHTML = '<option value="">Carregando hor√°rios...</option>';

    if (!medicoId) {
        selectAgenda.innerHTML = '<option value="">Escolha um m√©dico primeiro</option>';
        return;
    }

    fetch(`/horarios/${medicoId}`)
        .then(response => response.json())
        .then(data => {
            if (data.length === 0) {
                selectAgenda.innerHTML = '<option value="">Nenhum hor√°rio dispon√≠vel</option>';
                return;
            }
            let options = '<option value="">Selecione um hor√°rio</option>';
            data.forEach(item => {
                options += `<option value="${item.id}">${item.descricao}</option>`;
            });
            selectAgenda.innerHTML = options;
        })
        .catch(err => {
            console.error('Erro ao carregar hor√°rios:', err);
            selectAgenda.innerHTML = '<option value="">Erro ao carregar hor√°rios</option>';
        });
});
</script>

 <script>
    const toggle = document.getElementById('modo-toggle');
    const body = document.body;

    // Carregar modo salvo
    if (localStorage.getItem('modo') === 'dark') {
        body.classList.add('modo-escuro');
        toggle.textContent = 'üåû Light Mode';
    }

    toggle.addEventListener('click', () => {
        body.classList.toggle('modo-escuro');

        if (body.classList.contains('modo-escuro')) {
            localStorage.setItem('modo', 'dark');
            toggle.textContent = 'üåû Light Mode';
        } else {
            localStorage.setItem('modo', 'light');
            toggle.textContent = 'üåì Dark Mode';
        }
    });
</script>

</body>
</html>
